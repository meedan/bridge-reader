<!DOCTYPE html>
<!-- This is the child window -->
<html>

  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Bridge Embed</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <%= stylesheet_link_tag 'bridge', media: 'all' %>
    <%= javascript_include_tag 'jquery-2.1.3.min' %>
    <%= javascript_include_tag 'embed-child' %>
    <script async src="//cdn.embedly.com/widgets/platform.js" charset="UTF-8"></script>
  </head>

  <body class="bridgeEmbed">
      
    <% @translations.each do |translation| %>
    <div class="bridgeEmbed__item">
        
      <!-- Item Geodata -->
      <% unless translation[:oembed].coordinates.nil? %>
        <div class="bridgeEmbed__item-geodata">
          <a href="http://www.openstreetmap.org/?mlat=<%= translation[:oembed].coordinates[0] %>&mlon=<%= translation[:oembed].coordinates[1] %>&zoom=11#map=11/<%= translation[:oembed].coordinates[0] %>/<%= translation[:oembed].coordinates[1] %>" target="_blank">
            <i class="icon"></i>
            <%= translation[:oembed].coordinates[0] %>,
            <%= translation[:oembed].coordinates[1] %>
          </a>
        </div>
      <% end %>

      <!-- Item Title -->
      <!-- <a href="<%#= translation[:link] %>" class="bridgeEmbed__item-oembed-title">
        <%#= translation[:oembed].title || translation[:link] %>
      </a> -->
      
      <!-- Item Source -->
      <div class="bridgeEmbed__item-embedly-card-container">
        <a data-card-controls="0" data-card-width="100%" class="bridgeEmbed__item-embedly-card" href="<%= translation[:link] %>"></a>
      </div>

      <!-- Item Translation -->
      <div class="bridgeEmbed__item-translation">
        <div class="translation"><%= parse_translation translation %></div>
          
          <% unless translation[:translator_name].blank? %>
          <div class="byline">
            <span>Translated by </span>
            <%= link_to_unless translation[:translator_url].blank?, translation[:translator_name], translation[:translator_url],
                { target: '_blank', class: 'name' } %>
          </div>
          <% end %>

      </div>

      <!-- Item Annotations -->
      <% unless translation[:comment].blank? %>
        <div class="bridgeEmbed__item-comment">
          <%= parse_text translation[:comment] %>
          
          <% unless translation[:commenter].blank? %>
          — <span class="byline">
              <%= link_to_unless translation[:commenter_url].blank?, translation[:commenter], translation[:commenter_url],
                  { target: '_blank' } %>
            </span>
          <% end %>
        </div>
      <% end %>

    </div>
    <% end %>
    
    <div id="bridgeEmbed__footer">
      <a href="http://meedanlabs.com" target="_blank"><div>Powered by Bridge</div></a>
    </div>

    <script type="text/javascript">
      Bridge.milestone = '<%= @milestone %>';
    </script>
  </body>
</html>
